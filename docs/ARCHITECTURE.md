# Life OS - System Architecture

A deep dive into how Life OS is designed.

---

## Design Philosophy

### Core Principle: Config-Driven

**Everything personalizes from a single source of truth: `user-profile.json`**

- No hardcoded habits, topics, or goals
- One config file = infinite customization
- Easy to share, easy to fork

### Agent Architecture

**Commands orchestrate, agents work.**

- **Commands** = User-facing entry points (`/daily-checkin`, `/weekly-checkin`)
- **Agents** = Specialized AI workers with detailed instructions
- **Why agents?** Consistent, high-quality output. Reusable across commands.

### Local-First

**Your data never leaves your machine.**

- SQLite databases (not cloud)
- Markdown reports (not web UI)
- Terminal-based (not SaaS)
- Privacy by design

---

## System Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USER                            â”‚
â”‚          Runs commands via Claude Code CLI           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   COMMANDS    â”‚         â”‚  user-profile â”‚
â”‚  (6 total)    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚    .json      â”‚
â”‚               â”‚         â”‚               â”‚
â”‚ Entry points  â”‚         â”‚ Single source â”‚
â”‚ for users     â”‚         â”‚ of truth      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Calls agents
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    AGENTS     â”‚
â”‚  (7 total)    â”‚
â”‚               â”‚
â”‚ Specialized   â”‚
â”‚ AI workers    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Reads/writes
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DATABASES   â”‚         â”‚   REPORTS    â”‚
â”‚               â”‚         â”‚              â”‚
â”‚ habit-tracker â”‚         â”‚ daily-briefs â”‚
â”‚ brain-dumps   â”‚         â”‚ braindumps   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ weekly       â”‚
                          â”‚ quarterly    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Details

### 1. User Profile (user-profile.json)

**Schema:**

```json
{
  "user": {
    "name": "Sarah Chen",
    "timezone": "America/New_York",
    "wake_time": "06:00"
  },
  "career": {
    "current_role": "Product Designer",
    "target_role": "Senior Design Lead",
    "industries_of_interest": ["FinTech", "HealthTech"],
    "target_companies": ["Stripe", "Square", "Oscar Health"]
  },
  "content": {
    "active": true,
    "project_name": "Design Weekly",
    "platform": "Substack",
    "niche": "Product design for fintech"
  },
  "health": {
    "goals": ["Run 3x per week", "Meal prep Sundays"]
  },
  "learning_goals": ["Design systems", "Figma prototyping"],
  "daily_brief_topics": [
    "UX design trends",
    "FinTech product launches",
    "Design jobs at Stripe"
  ],
  "daily_habits": [
    {
      "id": "morning_pages",
      "question": "Did you write morning pages?",
      "type": "boolean"
    },
    {
      "id": "design_work",
      "question": "Minutes of design work today?",
      "type": "number"
    },
    {
      "id": "portfolio",
      "question": "Did you update your portfolio?",
      "type": "boolean"
    },
    {
      "id": "energy",
      "question": "Energy level (1-10)?",
      "type": "rating"
    },
    {
      "id": "mood",
      "question": "Mood (1-10)?",
      "type": "rating"
    },
    {
      "id": "wins",
      "question": "One win from today?",
      "type": "text"
    }
  ],
  "goals": {
    "career": "Senior Design Lead at fintech company by Q4 2026",
    "content": "Grow Design Weekly to 5K subscribers",
    "health": "Run a 5K race",
    "learning": "Master Figma advanced prototyping"
  }
}
```

**Generated by:** `/onboard` command

**Used by:** All commands and agents read from this file

---

### 2. Commands (6 Total)

Commands are user-facing entry points. They:
1. Read `user-profile.json` for context
2. Call specialized agents
3. Save results to databases/reports
4. Display summary to user

#### Command: `/onboard`

**Purpose:** Setup wizard for new users

**Process:**
1. Ask structured questions (AskUserQuestion tool):
   - Life areas (career, health, content, learning, etc.)
   - Current situation and goals
   - Topics for daily brief
2. AI suggests habits based on goals
3. Generate `user-profile.json`
4. Create databases (`habit-tracker.db`, `brain-dumps.db`)
5. Confirm setup complete

**Time:** ~5 minutes

**Output:** `user-profile.json`, databases created

---

#### Command: `/daily-brief`

**Purpose:** Personalized morning intelligence briefing

**Process:**
1. Read `user-profile.json` for topics
2. Check if today's brief already exists (avoid duplicates)
3. Call `brief-researcher` agent:
   - Web search for each topic
   - Fetch recent articles
   - Verify publication dates (must be NEW)
   - Return prioritized JSON (high/medium/low)
4. Call `brief-writer` agent:
   - Read research JSON
   - Connect to user's goals
   - Write readable brief (5-10 min read)
   - Save to `daily-briefs/brief-YYYY-MM-DD.md`
5. Display summary

**Time:** ~2 minutes to generate, 5-10 minutes to read

**Output:** `daily-briefs/brief-YYYY-MM-DD.md`

---

#### Command: `/daily-checkin`

**Purpose:** Evening habit tracking with insights

**Process:**
1. Read `user-profile.json` for habits to track
2. Check if already checked in today (offer to overwrite)
3. Call `checkin-coach` agent:
   - Ask each habit question conversationally
   - Save responses to `habit-tracker.db`
   - Calculate current streak
   - Calculate weekly stats
   - Analyze patterns (correlations, day-of-week trends)
   - Generate personalized insight
   - Display stats + insight
4. Show summary

**Time:** ~3-4 minutes

**Output:** Data saved to `databases/habit-tracker.db`

---

#### Command: `/bd-process`

**Purpose:** Capture and analyze brain dumps

**Format:** `/bd-process "Your thought here"`

**Process:**
1. Save raw entry to `braindumps/raw/YYYY-MM-DD-dump.txt`
2. Save to `brain-dumps.db`
3. Ask: "Run analysis on all brain dumps?" (optional)
4. If yes:
   - Call `insight-extractor` agent:
     - Read all brain dump files
     - Extract themes, connections, patterns
     - Return structured JSON
   - Call `brain-dump-analyst` agent:
     - Read JSON from extractor
     - Create ASCII mind map
     - List top 10 realizations (exact user quotes)
     - Show evolution timeline
     - Generate prioritized action items
     - Save to `braindumps/analysis/YYYY-MM-DD-analysis.md`
5. Display summary

**Time:** ~30 seconds to capture, ~2 minutes if running analysis

**Output:**
- `braindumps/raw/YYYY-MM-DD-dump.txt`
- `braindumps/analysis/YYYY-MM-DD-analysis.md` (if analyzed)
- Entry in `databases/brain-dumps.db`

---

#### Command: `/weekly-checkin`

**Purpose:** Weekly review and planning

**Process:**
1. Calculate current week (Sunday-Saturday)
2. Read `user-profile.json` for goals
3. Call `weekly-analyst` agent:
   - Load week's data from `habit-tracker.db`
   - Calculate stats (check-in rate, habit completion, averages)
   - Identify patterns (which days strong/weak, correlations)
   - Celebrate wins (streaks, personal bests, achievements)
   - Identify what worked and what struggled
   - Generate key insight
   - Suggest next week's focus (data-driven)
   - Optionally save report to `reports/weekly-YYYY-MM-DD.md`
4. Display review

**Time:** ~10-15 minutes to read

**Output:** Optional save to `reports/weekly-YYYY-MM-DD.md`

---

#### Command: `/quarterly-report`

**Purpose:** 12-week deep reflection

**Process:**
1. Calculate quarter dates (84 days back)
2. Verify sufficient data (warn if <21 days)
3. Read `user-profile.json` for context
4. Call `quarterly-analyst` agent:
   - Load 12 weeks of data from `habit-tracker.db`
   - Calculate quarter stats and trends
   - Identify macro trends (energy, consistency, momentum)
   - Find strongest patterns and correlations
   - Extract key breakthroughs (inflection points)
   - Compare to previous quarter (if exists)
   - Generate comprehensive report:
     - Executive summary
     - Quarter's story (narrative arc)
     - Wins and milestones
     - Lessons learned
     - Key insights and breakthroughs
     - Progress visualization
     - Next quarter priorities
   - Save to `reports/quarterly-Q#-YEAR.md`
5. Display summary

**Time:** ~15-20 minutes to read

**Output:** `reports/quarterly-Q#-YYYY.md`

---

### 3. Agents (7 Total)

Agents are specialized AI workers with detailed instructions (200-500 lines). They ensure consistent, high-quality output.

#### Agent: `insight-extractor`

**Purpose:** Extract structured insights from brain dumps

**Input:** All brain dump files in `braindumps/raw/`

**Process:**
- Read all dumps
- Extract recurring themes
- Identify evolution over time
- Find hidden connections
- Extract key questions user is asking
- Identify breakthrough moments
- Detect emotional patterns

**Output:** JSON with structured insights

**Used by:** `/bd-process` command

---

#### Agent: `brain-dump-analyst`

**Purpose:** Transform insights into beautiful visual report

**Input:** JSON from `insight-extractor` agent

**Process:**
- Create ASCII mind map showing theme connections
- List top 10 realizations (exact user quotes)
- Show evolution timeline
- Generate prioritized action items
- Celebrate breakthrough moments
- Show growth trajectory

**Output:** Formatted markdown report saved to `braindumps/analysis/`

**Used by:** `/bd-process` command

---

#### Agent: `brief-researcher`

**Purpose:** Research and gather intelligence for daily brief

**Input:** Topics from `user-profile.json`

**Process:**
- Web search for each topic
- Fetch recent articles (verify publication dates)
- Filter out old news (compare to yesterday's brief)
- Identify trends and patterns
- Prioritize by relevance (high/medium/low)
- Return structured JSON

**Output:** JSON with categorized, prioritized research

**Used by:** `/daily-brief` command

---

#### Agent: `brief-writer`

**Purpose:** Write personalized daily brief

**Input:**
- Research JSON from `brief-researcher`
- User context from `user-profile.json`

**Process:**
- Connect news to user's goals
- Write readable, actionable brief
- Organize by priority
- Add "Why this matters" context
- Keep under 5-10 min read time
- Save to `daily-briefs/`

**Output:** Formatted markdown brief

**Used by:** `/daily-brief` command

---

#### Agent: `checkin-coach`

**Purpose:** Guide user through daily check-in

**Input:**
- Habits from `user-profile.json`
- Historical data from `habit-tracker.db`

**Process:**
- Ask each habit question conversationally
- Save responses to database
- Calculate current streak
- Calculate weekly stats
- Analyze patterns (correlations, day-of-week trends)
- Generate personalized insight based on data
- Display stats and insight

**Output:** Database entries + stats display

**Used by:** `/daily-checkin` command

---

#### Agent: `weekly-analyst`

**Purpose:** Analyze weekly data and suggest next week's focus

**Input:**
- Week's data from `habit-tracker.db`
- User goals from `user-profile.json`

**Process:**
- Calculate weekly stats
- Identify what worked and what struggled
- Find patterns (day-of-week, habit correlations)
- Celebrate wins and streaks
- Generate key insight
- Suggest next week's focus (data-driven)

**Output:** Formatted weekly review report

**Used by:** `/weekly-checkin` command

---

#### Agent: `quarterly-analyst`

**Purpose:** Deep 12-week reflection and planning

**Input:**
- 12 weeks of data from `habit-tracker.db`
- User context from `user-profile.json`
- Previous quarterly reports (if exist)

**Process:**
- Calculate quarter stats and trends
- Identify macro trends (energy, momentum, evolution)
- Extract lessons learned (what worked, what didn't)
- Find breakthrough moments
- Compare to previous quarter
- Suggest next quarter priorities

**Output:** Comprehensive quarterly report

**Used by:** `/quarterly-report` command

---

### 4. Databases

#### habit-tracker.db

**Schema:**

```sql
CREATE TABLE daily_habits (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    date TEXT NOT NULL UNIQUE,
    -- Quantitative fields (dynamic based on user-profile.json)
    workout BOOLEAN,
    steps INTEGER,
    job_applications INTEGER,
    -- ... other habit fields ...

    -- Qualitative fields (always tracked)
    energy INTEGER,  -- 1-10 rating
    mood INTEGER,    -- 1-10 rating
    feeling TEXT,
    gratitude TEXT,
    challenges TEXT,
    wins TEXT,
    tomorrow_priority TEXT,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE VIEW current_streak AS
SELECT COUNT(*) as streak_days
FROM (
    SELECT date
    FROM daily_habits
    WHERE date >= DATE('now', '-' || (
        SELECT COUNT(*)
        FROM daily_habits d2
        WHERE d2.date > daily_habits.date
    ) || ' days')
    ORDER BY date
);

CREATE VIEW weekly_summary AS
SELECT
    COUNT(*) as days_checked_in,
    AVG(energy) as avg_energy,
    AVG(mood) as avg_mood,
    -- ... habit completion rates ...
FROM daily_habits
WHERE date >= DATE('now', '-7 days');
```

**Used by:** `/daily-checkin`, `/weekly-checkin`, `/quarterly-report`

---

#### brain-dumps.db

**Schema:**

```sql
CREATE TABLE entries (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    date TEXT NOT NULL,
    content TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE tags (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    entry_id INTEGER,
    tag TEXT,
    FOREIGN KEY (entry_id) REFERENCES entries(id)
);

CREATE TABLE insights (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    analysis_date TEXT NOT NULL,
    themes TEXT,  -- JSON array
    connections TEXT,  -- JSON array
    action_items TEXT,  -- JSON array
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**Used by:** `/bd-process`, insight-extractor agent, brain-dump-analyst agent

---

## Data Flow Examples

### Example 1: Daily Check-In Flow

```
User runs: /daily-checkin

1. Command reads user-profile.json
   â†’ Gets list of habits to track

2. Command calls checkin-coach agent
   â†’ Agent asks questions interactively
   â†’ User answers each question

3. Agent saves to habit-tracker.db
   â†’ INSERT INTO daily_habits (date, workout, energy, mood, ...)

4. Agent calculates metrics
   â†’ Current streak: SELECT from current_streak view
   â†’ Weekly stats: SELECT from weekly_summary view

5. Agent analyzes patterns
   â†’ Correlation: workout days vs. energy levels
   â†’ Day-of-week: Monday energy vs. Friday energy

6. Agent generates insight
   â†’ "You're 23% more productive on days you work out"

7. Display to user:
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   âœ… Check-in complete for Friday, Jan 30

   ğŸ“Š YOUR STATS
   ğŸ”¥ Current streak: 12 days
   ğŸ“ˆ This week: 5/7 days
   âš¡ Avg energy: 7.4/10

   ğŸ’¡ YOUR INSIGHT
   [Personalized insight based on patterns]
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

### Example 2: Brain Dump Analysis Flow

```
User runs: /bd-process "Feeling stressed about interviews"

1. Command saves raw entry
   â†’ braindumps/raw/2026-01-30-dump.txt
   â†’ INSERT INTO brain-dumps.db entries table

2. Command asks: "Run analysis?" â†’ User says yes

3. Command calls insight-extractor agent
   â†’ Agent reads ALL files in braindumps/raw/
   â†’ Identifies themes: ["career", "stress", "interviews"]
   â†’ Finds patterns: User mentions "interviews" 7 times
   â†’ Detects evolution: Stress increased over 2 weeks
   â†’ Returns JSON:
   {
     "themes": ["Career anxiety", "Interview prep"],
     "recurring_topics": ["interviews", "confidence"],
     "evolution": "Stress escalating",
     "connections": ["Interview stress â†’ sleep issues"],
     "action_items": ["Schedule mock interviews"]
   }

4. Command calls brain-dump-analyst agent
   â†’ Receives JSON from step 3
   â†’ Creates ASCII mind map
   â†’ Lists top 10 user realizations (exact quotes)
   â†’ Generates prioritized action items
   â†’ Saves to braindumps/analysis/2026-01-30-analysis.md

5. Display summary to user:
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   âœ… Brain dump processed!

   Top 3 themes:
   1. Career anxiety
   2. Interview preparation
   3. Confidence building

   High-priority action:
   â–¡ Schedule 3 mock interviews this week

   Full report: braindumps/analysis/2026-01-30-analysis.md
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## Why This Architecture?

### 1. Config-Driven = Universal

**Problem:** Original Life OS was hardcoded to Tarun's goals

**Solution:** Single config file (`user-profile.json`) drives everything

**Result:**
- Anyone can use it (just run `/onboard`)
- Easy to customize (edit JSON)
- Shareable (no personal data in code)

---

### 2. Agent-Based = Consistent Quality

**Problem:** Commands with inline prompts produce inconsistent output

**Solution:** Dedicated agents with 200-500 line instructions

**Result:**
- High-quality, standardized output every time
- Easy to maintain (update agent, all commands improve)
- Reusable (multiple commands use same agent)

---

### 3. Two-Stage Pipelines = Separation of Concerns

**Problem:** Single agent doing research + writing = mediocre at both

**Solution:** Split into extract â†’ format pipelines

**Example:**
- `insight-extractor` (extract data) â†’ `brain-dump-analyst` (format beautifully)
- `brief-researcher` (gather intel) â†’ `brief-writer` (synthesize + personalize)

**Result:** Each agent specializes, quality improves

---

### 4. Local-First = Privacy + Control

**Problem:** SaaS products require trusting third parties with personal data

**Solution:** SQLite databases, markdown files, terminal-based

**Result:**
- Complete privacy (data never leaves machine)
- Full control (own your data)
- No monthly fees
- Works offline

---

## Technical Stack

**Runtime:** Claude Code CLI
**Language:** Commands use Claude's natural language + Python snippets
**Agents:** Markdown instruction files (interpreted by Claude)
**Databases:** SQLite 3
**Reports:** Markdown
**Config:** JSON
**Version Control:** Git

**Dependencies:**
- Claude Code CLI (includes Claude API access)
- Python 3.x (for database operations)
- SQLite 3 (comes with Python)

**No external APIs required** (except Claude, which comes with Claude Code)

---

## Extension Points

### Add a New Habit

1. Edit `user-profile.json`:
   ```json
   {
     "daily_habits": [
       {
         "id": "meditation",
         "question": "Did you meditate today?",
         "type": "boolean"
       }
     ]
   }
   ```

2. Run `/daily-checkin` â†’ Automatically asks new question

### Add a New Command

1. Create `.claude/commands/your-command.md`
2. Define process and agent calls
3. Run `/your-command` in Claude Code

### Add a New Agent

1. Create `.claude/agents/your-agent.md`
2. Write detailed instructions (200+ lines)
3. Commands can now call this agent

### Add a New Database

1. Define schema in onboarding command
2. Agents read/write to new database
3. Commands orchestrate data flow

---

## Performance Considerations

**Database Size:**
- habit-tracker.db: ~1 MB per year of daily check-ins
- brain-dumps.db: ~5-10 MB per 1000 dumps

**Command Speed:**
- `/daily-checkin`: ~30-60 seconds (interactive Q&A)
- `/daily-brief`: ~60-120 seconds (research + writing)
- `/bd-process`: ~10 seconds (save only) or ~60 seconds (with analysis)
- `/weekly-checkin`: ~30-60 seconds
- `/quarterly-report`: ~60-90 seconds

**Agent Quality vs. Speed:**
- Longer, more detailed agent prompts = slower but higher quality
- Current balance: 200-500 line agents = ~60 second responses
- Acceptable tradeoff for daily use

---

## Security & Privacy

**Data Storage:**
- All data stored locally on user's machine
- No cloud uploads
- No external API calls (except Claude for AI processing)

**Git Ignore:**
```
user-profile.json
user-background.md
databases/
daily-briefs/
braindumps/
reports/
```

**Result:** Personal data never committed to Git, safe to share repository

---

## Future Enhancements

**Potential additions (not in v1):**
- Export to PDF
- Data visualization (charts, graphs)
- Mobile companion app
- Habit correlations dashboard
- Goal progress tracking
- Multi-user support (teams)

**Philosophy:** Ship focused, iterate based on real usage.

---

**This architecture balances simplicity, flexibility, and quality.**
